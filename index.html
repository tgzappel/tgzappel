<!--fix-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The List | Levels</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <a href="index.html" class="active">LEVELS</a>
        <a href="leaderboard.html">LEADERBOARD</a>
    </nav>

    <div id="main-layout">
        <aside id="sidebar">
            <h3>Filter Skills</h3>
            <div id="tag-filters">
                <button class="tag-btn" onclick="toggleTag('Precision')">Precision</button>
                <button class="tag-btn" onclick="toggleTag('Speedrun')">Speedrun</button>
                <button class="tag-btn" onclick="toggleTag('Memory')">Memory</button>
                <button class="tag-btn" onclick="toggleTag('Timing')">Timing</button>
            </div>
            <button id="clear-btn" onclick="clearFilters()">Clear Filters</button>
        </aside>

        <main id="container">
            <input type="text" id="searchBar" placeholder="Search level, author, or verifier..." onkeyup="filterLevels()">
            <div id="list-view"></div>
        </main>
    </div>

    <div id="infoModal" class="modal"><div class="modal-content">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <div id="modal-body"></div>
    </div></div>

    <script src="data.js"></script>
    <script>
        let activeTags = [];
        function toggleTag(tag) {
            const btn = event.target;
            activeTags.includes(tag) ? activeTags = activeTags.filter(t => t !== tag) : activeTags.push(tag);
            btn.classList.toggle('active-tag');
            filterLevels();
        }
        function clearFilters() {
            activeTags = [];
            document.querySelectorAll('.tag-btn').forEach(b => b.classList.remove('active-tag'));
            document.getElementById('searchBar').value = "";
            filterLevels();
        }
        function filterLevels() {
            const search = document.getElementById('searchBar').value.toLowerCase();
            const filtered = DATA.levels.filter(lvl => {
                const matchesSearch = lvl.name.toLowerCase().includes(search) || lvl.author.toLowerCase().includes(search);
                const matchesTags = activeTags.length === 0 || activeTags.every(t => lvl.skills.includes(t));
                return matchesSearch && matchesTags;
            });
            document.getElementById('list-view').innerHTML = filtered.map(lvl => `
                <div class="card" onclick="showLevelDetails('${lvl.id}')">
                    <img src="${lvl.img}" onerror="this.src='https://via.placeholder.com/300x200'">
                    <div class="info"><h2>${lvl.name}</h2><p>By ${lvl.author}</p></div>
                </div>`).join('');
        }
        function renderLevels() { filterLevels(); }
        function showLevelDetails(id) {
            const lvl = DATA.levels.find(l => l.id === id);
            const victors = DATA.players.filter(p => p.completions.includes(id));
            document.getElementById('modal-body').innerHTML = `
                <h2>${lvl.name}</h2><p>by ${lvl.author}</p>
                <div class="stat-grid">
                    <div><span>ENJOYMENT</span><strong>${lvl.enjoyment}</strong></div>
                    <div><span>RATIO</span><strong>${lvl.ratio}</strong></div>
                    <div><span>QUALITY</span><strong>${lvl.quality}</strong></div>
                </div>
                <p><strong>Verified by:</strong> ${lvl.verifier}</p>
                <p><strong>Skills:</strong> ${lvl.skills}</p>
                <hr><h3>Victors (${victors.length})</h3>
                <ul>${victors.map(v => `<li>${v.name}</li>`).join('')}</ul>`;
            document.getElementById('infoModal').style.display = "block";
        }
        function closeModal() { document.getElementById('infoModal').style.display = "none"; }
    </script>
</body>
</html>
